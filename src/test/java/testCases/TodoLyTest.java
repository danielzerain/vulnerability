package testCases;

import io.qameta.allure.Description;
import io.qameta.allure.Link;
import io.qameta.allure.Severity;
import io.qameta.allure.SeverityLevel;
import org.junit.jupiter.api.*;
import pageObject.LoginModal;
import pageObject.MainPage;
import pageObject.TodoPage;
import session.Session;
import utils.ConfigEnv;
import utils.GetProperties;

public class TodoLyTest {

    MainPage mainPage = new MainPage();
    LoginModal loginModal = new LoginModal();
    TodoPage todoPage=new TodoPage();

    @BeforeEach
    public void before() throws Exception {
        new GetProperties().readProperties();
        Session.getInstance().getDriver().get(ConfigEnv.host);
    }

    @DisplayName("Creación de Proyecto")
    @Description("Creación de un proyecto en la pagina todo.ly por UI")
    @Link("https://todo.ly")
    @Severity(SeverityLevel.CRITICAL)
    @Test
    public void verifyLogin() throws Exception {
        mainPage.loginButton.click();
        loginModal.emailTextBox.setValue(ConfigEnv.user);
        loginModal.passwordTextBox.setValue(ConfigEnv.password);
        loginModal.loginButton.click();
        todoPage.addNewProjectButton.click();
        todoPage.inputAddProjectText.setValue("Proyecto Modulo");
        todoPage.saveNewProjectButton.click();
        todoPage.inputAddItemText.setValue("Item nuevo");
        todoPage.saveNewItemButton.click();
        Thread.sleep(2000);
        Assertions.assertEquals("Proyecto Modulo", todoPage.currentProjectLabel.getValue());
    }


    @AfterEach
    public void after() throws Exception {
        Session.getInstance().closeSession();
    }

}
